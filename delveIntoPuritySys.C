#include <fstream>
#include <vector>
void delveIntoPuritySys(){

  gStyle->SetOptStat(0);
  gStyle->SetLegendBorderSize(0);
  gStyle->SetEndErrorSize(5);
  
  
  TLine *line = new TLine(12, 1, 54, 1);
  line->SetLineColor(kBlue);
  
  const int nbins = 100;
  Double_t xBins[nbins] = {0.01, 0.03, 0.05, 0.07, 0.09, 0.11, 0.13, 0.15, 0.17, 0.19,
			 0.21, 0.23, 0.25, 0.27, 0.29, 0.31, 0.33, 0.35, 0.37, 0.39,
			 0.41, 0.43, 0.45, 0.47, 0.49, 0.51, 0.53, 0.55, 0.57, 0.59,
			 0.61, 0.63, 0.65, 0.67, 0.69, 0.71, 0.73, 0.75, 0.77, 0.79,
			 0.81, 0.83, 0.85, 0.87, 0.89, 0.91, 0.93, 0.95, 0.97, 0.99,
			 1.01, 1.03, 1.05, 1.07, 1.09, 1.11, 1.13, 1.15, 1.17, 1.19,
			 1.21, 1.23, 1.25, 1.27, 1.29, 1.31, 1.33, 1.35, 1.37, 1.39,
			 1.41, 1.43, 1.45, 1.47, 1.49, 1.51, 1.53, 1.55, 1.57, 1.59,
			 1.61, 1.63, 1.65, 1.67, 1.69, 1.71, 1.73, 1.75, 1.77, 1.79,
			 1.81, 1.83, 1.85, 1.87, 1.89, 1.91, 1.93, 1.95, 1.97, 1.99};
  
  Double_t firstBin_sig_pp[nbins] = {0.0000000e+00, 0.0000000e+00, 0.0000000e+00, 0.0000000e+00, 0.0000000e+00,
				     8.6710922e-04, 3.2219659e-03, 1.3108529e-02, 2.7262695e-02, 5.4801162e-02,
				     8.6608909e-02, 1.5091142e-01, 2.5312117e-01, 8.9317501e-02, 5.7057600e-02,
				     3.7779175e-02, 2.7999731e-02, 1.9382771e-02, 1.4051259e-02, 1.2327719e-02,
				     1.1054217e-02, 9.9321771e-03, 9.0511767e-03, 8.4779141e-03, 7.6246639e-03,
				     6.7929891e-03, 6.4616576e-03, 5.9366417e-03, 5.8587161e-03, 5.2949325e-03,
				     4.8474576e-03, 4.2706747e-03, 3.4303947e-03, 3.2670177e-03, 3.2385290e-03,
				     3.2814189e-03, 3.0974448e-03, 2.0824596e-03, 2.6552198e-03, 2.1311452e-03,
				     2.0077471e-03, 1.9699342e-03, 2.1504178e-03, 1.9205456e-03, 1.9928443e-03,
				     1.9488605e-03, 1.6301523e-03, 1.7017416e-03, 1.6693103e-03, 1.3267818e-03,
				     1.4641905e-03, 1.4286689e-03, 1.1107039e-03, 1.2306616e-03, 1.0135877e-03,
				     7.4718444e-04, 8.1117114e-04, 1.1790964e-03, 8.2961755e-04, 5.9663720e-04,
				     7.2869984e-04, 1.0392464e-03, 5.3615315e-04, 5.2302080e-04, 6.3160958e-04,
				     4.6198018e-04, 5.7890848e-04, 4.6046166e-04, 4.7740582e-04, 6.7074620e-04,
				     5.9951289e-04, 4.2629210e-04, 6.2034052e-04, 5.1625737e-04, 4.6351372e-04,
				     4.0557937e-04, 2.6504486e-04, 3.8608853e-04, 3.9477382e-04, 4.0106487e-04,
				     1.9909622e-04, 4.6461113e-04, 2.3547157e-04, 4.1772012e-04, 1.8624953e-04,
				     2.5794419e-04, 1.9422374e-04, 1.3907246e-04, 2.2829584e-04, 2.1731871e-04,
				     2.0606598e-04, 1.8963835e-04, 1.5416945e-04, 1.9483530e-04, 8.0585240e-05,
				     1.2418401e-04, 9.2582013e-05, 1.2619265e-04, 2.5275064e-04, 1.1686808e-04};
  
  Double_t firstBin_bkg_pp[nbins] = {0.        , 0.        , 0.        , 0.        , 0.        , 0.00083271,
				     0.00173175, 0.0047853 , 0.0111522 , 0.02109193, 0.03147313, 0.04935508,
				     0.08208692, 0.02494623, 0.01799001, 0.01273282, 0.01226407, 0.0110536,
				     0.01211962, 0.00888801, 0.0104692 , 0.00944764, 0.00939327, 0.0092104,
				     0.00911071, 0.0100144 , 0.01065567, 0.0124469 , 0.01079415, 0.01422665,
				     0.01533191, 0.01627574, 0.016062  , 0.01600515, 0.01742694, 0.01908782,
				     0.0192205 , 0.02093981, 0.02402393, 0.02174155, 0.02325065, 0.0236295,
				     0.02294342, 0.02290199, 0.01911232, 0.01925578, 0.01644242, 0.01800346,
				     0.01457298, 0.01295634, 0.01209569, 0.01233048, 0.01261429, 0.01237205,
				     0.01149379, 0.00796459, 0.00999233, 0.00857895, 0.00889021, 0.00724814,
				     0.00787417, 0.00596927, 0.00559467, 0.00553323, 0.00496027, 0.00570894,
				     0.00463872, 0.00438026, 0.00464902, 0.00356009, 0.00352736, 0.00339402,
				     0.00287328, 0.00229062, 0.002135  , 0.00351088, 0.0026677 , 0.00244273,
				     0.00217573, 0.00223199, 0.00227551, 0.00172177, 0.00126699, 0.00219927,
				     0.00210452, 0.00138557, 0.00239953, 0.00160964, 0.00179985, 0.00152453,
				     0.00145781, 0.00114821, 0.00074322, 0.00098646, 0.00133748, 0.00126463,
				     0.00089389, 0.0006865 , 0.00100564, 0.00103391};

  Double_t firstBin_sig_pPb[nbins] = {0.0000000e+00, 0.0000000e+00, 0.0000000e+00, 0.0000000e+00, 0.0000000e+00,
				      9.6263492e-04, 4.1585313e-03, 1.2949031e-02, 3.0002218e-02, 5.6883443e-02,
				      9.5546640e-02, 1.5363503e-01, 2.6551685e-01, 9.5889330e-02, 5.8327179e-02,
				      3.8326375e-02, 2.5935080e-02, 1.7585203e-02, 1.3278703e-02, 1.1085058e-02,
				      8.4656999e-03, 8.0692768e-03, 6.9529517e-03, 6.7691426e-03, 5.0429427e-03,
				      5.2692494e-03, 5.1341215e-03, 4.7432161e-03, 4.6126260e-03, 3.9682076e-03,
				      4.2025247e-03, 3.2334218e-03, 2.8697925e-03, 3.2889643e-03, 2.3354783e-03,
				      2.3698704e-03, 2.1229719e-03, 2.1313180e-03, 2.1091050e-03, 1.5386231e-03,
				      2.3925833e-03, 1.5186593e-03, 1.5024423e-03, 1.5072612e-03, 1.2563594e-03,
				      1.2918540e-03, 1.1731050e-03, 1.3266668e-03, 1.2637335e-03, 1.1900630e-03,
				      9.8291668e-04, 1.0626003e-03, 1.0733267e-03, 1.0493975e-03, 7.5549696e-04,
				      7.8218023e-04, 9.1753376e-04, 6.0886971e-04, 6.8135920e-04, 6.1556109e-04,
				      6.8580930e-04, 5.1145477e-04, 5.9755082e-04, 5.6126533e-04, 5.0588272e-04,
				      4.0972506e-04, 3.1902868e-04, 3.7077838e-04, 4.2737494e-04, 4.3630408e-04,
				      3.1241789e-04, 3.4338920e-04, 2.7999311e-04, 4.2092570e-04, 2.0885066e-04,
				      5.7763647e-04, 4.1177278e-04, 1.8868584e-04, 1.9747704e-04, 2.7684140e-04,
				      4.0825497e-04, 1.5111551e-04, 1.1668901e-04, 2.0942870e-04, 1.4002042e-04,
				      2.8584807e-04, 7.4602438e-05, 2.4981922e-04, 2.1707125e-04, 1.2843354e-04,
				      7.8571727e-05, 1.8999346e-04, 1.3726503e-04, 1.4570504e-04, 1.7401908e-04,
				      2.2627367e-04, 2.8734532e-04, 1.5198741e-04, 1.8453042e-04, 1.3708987e-04};

  Double_t firstBin_bkg_pPb[nbins] = {0.        , 0.        , 0.        , 0.        , 0.        , 0.00055389,
				      0.00139896, 0.00577556, 0.00996476, 0.02203002, 0.0316366 , 0.05186921,
				      0.08219928, 0.02674021, 0.01704826, 0.01557676, 0.0115392 , 0.01124578,
				      0.01024791, 0.00930643, 0.00882656, 0.00872818, 0.00853859, 0.0097475,
				      0.00965316, 0.01103894, 0.01196661, 0.01318453, 0.01379755, 0.01493493,
				      0.01467635, 0.01628835, 0.01705671, 0.01760373, 0.01924399, 0.01928044,
				      0.02040843, 0.02399148, 0.02348933, 0.02384436, 0.02371348, 0.02528396,
				      0.02313663, 0.02007716, 0.02043878, 0.01894646, 0.01809293, 0.01463368,
				      0.01470333, 0.01325666, 0.01234488, 0.012335  , 0.01209252, 0.0108147,
				      0.01048154, 0.00818842, 0.00879425, 0.00759419, 0.00721705, 0.00717869,
				      0.00608216, 0.00552102, 0.00648731, 0.00546228, 0.00601475, 0.00427344,
				      0.00420027, 0.00452615, 0.00415241, 0.00351514, 0.00334364, 0.00294443,
				      0.0028438 , 0.00239063, 0.00221907, 0.00246768, 0.0023451 , 0.00197066,
				      0.00201886, 0.00187633, 0.00156948, 0.00170548, 0.00160687, 0.00158683,
				      0.00162849, 0.00146277, 0.00127415, 0.00125812, 0.00119721, 0.00128844,
				      0.00097361, 0.00103202, 0.00093056, 0.00087748, 0.000809  , 0.00055511,
				      0.00063315, 0.00086532, 0.00077596, 0.00055785};

  TH1F* hFirstBin_sig_pp = new TH1F("hFirstBin_sig_pp", "12 GeV/c< p_{T} < 14 GeV/c;#sigma^{2}_{long};arbitary units", 100, 0, 2.00);
  TH1F* hFirstBin_bkg_pp = new TH1F("hFirstBin_bkg_pp", "12 GeV/c< p_{T} < 14 GeV/c;#sigma^{2}_{long};arbitary units", 100, 0, 2.00);
  TH1F* hFirstBin_sig_pPb = new TH1F("hFirstBin_sig_pPb", "12 GeV/c< p_{T} < 14 GeV/c;#sigma^{2}_{long};arbitary units", 100, 0, 2.00);
  TH1F* hFirstBin_bkg_pPb = new TH1F("hFirstBin_bkg_pPb", "12 GeV/c< p_{T} < 14 GeV/c;#sigma^{2}_{long};arbitary units", 100, 0, 2.00);
  TH1F* hFirstBin_sig_rat = new TH1F("hFirstBin_sig_rat", "Signal: 12 GeV/c< p_{T} < 14 GeV/c;#sigma^{2}_{long};pp/pPb", 100, 0, 2.00);
  TH1F* hFirstBin_bkg_rat = new TH1F("hFirstBin_bkg_rat", "Background: 12 GeV/c< p_{T} < 14 GeV/c;#sigma^{2}_{long};pp/pPb", 100, 0, 2.00);

  for(int i = 1; i <  hFirstBin_sig_pp->GetNbinsX(); i++){
    hFirstBin_sig_pp->SetBinContent(i, firstBin_sig_pp[i]);
    hFirstBin_bkg_pp->SetBinContent(i, firstBin_bkg_pp[i]);
    hFirstBin_sig_pPb->SetBinContent(i, firstBin_sig_pPb[i]);
    hFirstBin_bkg_pPb->SetBinContent(i, firstBin_bkg_pPb[i]);
    if(firstBin_sig_pPb[i] != 0)
      hFirstBin_sig_rat->SetBinContent(i, firstBin_sig_pp[i]/firstBin_sig_pPb[i]);
    if(firstBin_bkg_pPb[i] != 0)
      hFirstBin_bkg_rat->SetBinContent(i, firstBin_bkg_pp[i]/firstBin_bkg_pPb[i]);
  }

  TCanvas* cFirstBin_sig = new TCanvas("cFirstBin_sig", "cFirstBin_sig");
  hFirstBin_sig_rat->SetMarkerStyle(kFullCircle);
  hFirstBin_sig_rat->Draw("P");

  TCanvas* cFirstBin_bkg = new TCanvas("cFirstBin_bkg", "cFirstBin_bkg");
  hFirstBin_bkg_rat->SetMarkerStyle(kFullCircle);
  hFirstBin_bkg_rat->Draw("P");

    
}//end delveIntoPuritySys
