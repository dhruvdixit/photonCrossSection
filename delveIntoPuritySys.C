#include <fstream>
#include <vector>
void delveIntoPuritySys(){

  gStyle->SetOptStat(0);
  gStyle->SetLegendBorderSize(0);
  gStyle->SetEndErrorSize(5);
  
  
  TLine *line = new TLine(12, 1, 54, 1);
  line->SetLineColor(kBlue);
  
  const int nbins = 100;
  Double_t xBins[nbins] = {0.01, 0.03, 0.05, 0.07, 0.09, 0.11, 0.13, 0.15, 0.17, 0.19,
			 0.21, 0.23, 0.25, 0.27, 0.29, 0.31, 0.33, 0.35, 0.37, 0.39,
			 0.41, 0.43, 0.45, 0.47, 0.49, 0.51, 0.53, 0.55, 0.57, 0.59,
			 0.61, 0.63, 0.65, 0.67, 0.69, 0.71, 0.73, 0.75, 0.77, 0.79,
			 0.81, 0.83, 0.85, 0.87, 0.89, 0.91, 0.93, 0.95, 0.97, 0.99,
			 1.01, 1.03, 1.05, 1.07, 1.09, 1.11, 1.13, 1.15, 1.17, 1.19,
			 1.21, 1.23, 1.25, 1.27, 1.29, 1.31, 1.33, 1.35, 1.37, 1.39,
			 1.41, 1.43, 1.45, 1.47, 1.49, 1.51, 1.53, 1.55, 1.57, 1.59,
			 1.61, 1.63, 1.65, 1.67, 1.69, 1.71, 1.73, 1.75, 1.77, 1.79,
			 1.81, 1.83, 1.85, 1.87, 1.89, 1.91, 1.93, 1.95, 1.97, 1.99};
  
  Double_t firstBin_sig_pp[nbins] = {0.0000000e+00, 0.0000000e+00, 0.0000000e+00, 0.0000000e+00, 0.0000000e+00,
				     8.6710922e-04, 3.2219659e-03, 1.3108529e-02, 2.7262695e-02, 5.4801162e-02,
				     8.6608909e-02, 1.5091142e-01, 2.5312117e-01, 8.9317501e-02, 5.7057600e-02,
				     3.7779175e-02, 2.7999731e-02, 1.9382771e-02, 1.4051259e-02, 1.2327719e-02,
				     1.1054217e-02, 9.9321771e-03, 9.0511767e-03, 8.4779141e-03, 7.6246639e-03,
				     6.7929891e-03, 6.4616576e-03, 5.9366417e-03, 5.8587161e-03, 5.2949325e-03,
				     4.8474576e-03, 4.2706747e-03, 3.4303947e-03, 3.2670177e-03, 3.2385290e-03,
				     3.2814189e-03, 3.0974448e-03, 2.0824596e-03, 2.6552198e-03, 2.1311452e-03,
				     2.0077471e-03, 1.9699342e-03, 2.1504178e-03, 1.9205456e-03, 1.9928443e-03,
				     1.9488605e-03, 1.6301523e-03, 1.7017416e-03, 1.6693103e-03, 1.3267818e-03,
				     1.4641905e-03, 1.4286689e-03, 1.1107039e-03, 1.2306616e-03, 1.0135877e-03,
				     7.4718444e-04, 8.1117114e-04, 1.1790964e-03, 8.2961755e-04, 5.9663720e-04,
				     7.2869984e-04, 1.0392464e-03, 5.3615315e-04, 5.2302080e-04, 6.3160958e-04,
				     4.6198018e-04, 5.7890848e-04, 4.6046166e-04, 4.7740582e-04, 6.7074620e-04,
				     5.9951289e-04, 4.2629210e-04, 6.2034052e-04, 5.1625737e-04, 4.6351372e-04,
				     4.0557937e-04, 2.6504486e-04, 3.8608853e-04, 3.9477382e-04, 4.0106487e-04,
				     1.9909622e-04, 4.6461113e-04, 2.3547157e-04, 4.1772012e-04, 1.8624953e-04,
				     2.5794419e-04, 1.9422374e-04, 1.3907246e-04, 2.2829584e-04, 2.1731871e-04,
				     2.0606598e-04, 1.8963835e-04, 1.5416945e-04, 1.9483530e-04, 8.0585240e-05,
				     1.2418401e-04, 9.2582013e-05, 1.2619265e-04, 2.5275064e-04, 1.1686808e-04};
  
  Double_t firstBin_bkg_pp[nbins] = {0.        , 0.        , 0.        , 0.        , 0.        , 0.00083271,
				     0.00173175, 0.0047853 , 0.0111522 , 0.02109193, 0.03147313, 0.04935508,
				     0.08208692, 0.02494623, 0.01799001, 0.01273282, 0.01226407, 0.0110536,
				     0.01211962, 0.00888801, 0.0104692 , 0.00944764, 0.00939327, 0.0092104,
				     0.00911071, 0.0100144 , 0.01065567, 0.0124469 , 0.01079415, 0.01422665,
				     0.01533191, 0.01627574, 0.016062  , 0.01600515, 0.01742694, 0.01908782,
				     0.0192205 , 0.02093981, 0.02402393, 0.02174155, 0.02325065, 0.0236295,
				     0.02294342, 0.02290199, 0.01911232, 0.01925578, 0.01644242, 0.01800346,
				     0.01457298, 0.01295634, 0.01209569, 0.01233048, 0.01261429, 0.01237205,
				     0.01149379, 0.00796459, 0.00999233, 0.00857895, 0.00889021, 0.00724814,
				     0.00787417, 0.00596927, 0.00559467, 0.00553323, 0.00496027, 0.00570894,
				     0.00463872, 0.00438026, 0.00464902, 0.00356009, 0.00352736, 0.00339402,
				     0.00287328, 0.00229062, 0.002135  , 0.00351088, 0.0026677 , 0.00244273,
				     0.00217573, 0.00223199, 0.00227551, 0.00172177, 0.00126699, 0.00219927,
				     0.00210452, 0.00138557, 0.00239953, 0.00160964, 0.00179985, 0.00152453,
				     0.00145781, 0.00114821, 0.00074322, 0.00098646, 0.00133748, 0.00126463,
				     0.00089389, 0.0006865 , 0.00100564, 0.00103391};

  Double_t firstBin_sig_pPb[nbins] = {0.0000000e+00, 0.0000000e+00, 0.0000000e+00, 0.0000000e+00, 0.0000000e+00,
				      9.6263492e-04, 4.1585313e-03, 1.2949031e-02, 3.0002218e-02, 5.6883443e-02,
				      9.5546640e-02, 1.5363503e-01, 2.6551685e-01, 9.5889330e-02, 5.8327179e-02,
				      3.8326375e-02, 2.5935080e-02, 1.7585203e-02, 1.3278703e-02, 1.1085058e-02,
				      8.4656999e-03, 8.0692768e-03, 6.9529517e-03, 6.7691426e-03, 5.0429427e-03,
				      5.2692494e-03, 5.1341215e-03, 4.7432161e-03, 4.6126260e-03, 3.9682076e-03,
				      4.2025247e-03, 3.2334218e-03, 2.8697925e-03, 3.2889643e-03, 2.3354783e-03,
				      2.3698704e-03, 2.1229719e-03, 2.1313180e-03, 2.1091050e-03, 1.5386231e-03,
				      2.3925833e-03, 1.5186593e-03, 1.5024423e-03, 1.5072612e-03, 1.2563594e-03,
				      1.2918540e-03, 1.1731050e-03, 1.3266668e-03, 1.2637335e-03, 1.1900630e-03,
				      9.8291668e-04, 1.0626003e-03, 1.0733267e-03, 1.0493975e-03, 7.5549696e-04,
				      7.8218023e-04, 9.1753376e-04, 6.0886971e-04, 6.8135920e-04, 6.1556109e-04,
				      6.8580930e-04, 5.1145477e-04, 5.9755082e-04, 5.6126533e-04, 5.0588272e-04,
				      4.0972506e-04, 3.1902868e-04, 3.7077838e-04, 4.2737494e-04, 4.3630408e-04,
				      3.1241789e-04, 3.4338920e-04, 2.7999311e-04, 4.2092570e-04, 2.0885066e-04,
				      5.7763647e-04, 4.1177278e-04, 1.8868584e-04, 1.9747704e-04, 2.7684140e-04,
				      4.0825497e-04, 1.5111551e-04, 1.1668901e-04, 2.0942870e-04, 1.4002042e-04,
				      2.8584807e-04, 7.4602438e-05, 2.4981922e-04, 2.1707125e-04, 1.2843354e-04,
				      7.8571727e-05, 1.8999346e-04, 1.3726503e-04, 1.4570504e-04, 1.7401908e-04,
				      2.2627367e-04, 2.8734532e-04, 1.5198741e-04, 1.8453042e-04, 1.3708987e-04};

  Double_t firstBin_bkg_pPb[nbins] = {0.        , 0.        , 0.        , 0.        , 0.        , 0.00055389,
				      0.00139896, 0.00577556, 0.00996476, 0.02203002, 0.0316366 , 0.05186921,
				      0.08219928, 0.02674021, 0.01704826, 0.01557676, 0.0115392 , 0.01124578,
				      0.01024791, 0.00930643, 0.00882656, 0.00872818, 0.00853859, 0.0097475,
				      0.00965316, 0.01103894, 0.01196661, 0.01318453, 0.01379755, 0.01493493,
				      0.01467635, 0.01628835, 0.01705671, 0.01760373, 0.01924399, 0.01928044,
				      0.02040843, 0.02399148, 0.02348933, 0.02384436, 0.02371348, 0.02528396,
				      0.02313663, 0.02007716, 0.02043878, 0.01894646, 0.01809293, 0.01463368,
				      0.01470333, 0.01325666, 0.01234488, 0.012335  , 0.01209252, 0.0108147,
				      0.01048154, 0.00818842, 0.00879425, 0.00759419, 0.00721705, 0.00717869,
				      0.00608216, 0.00552102, 0.00648731, 0.00546228, 0.00601475, 0.00427344,
				      0.00420027, 0.00452615, 0.00415241, 0.00351514, 0.00334364, 0.00294443,
				      0.0028438 , 0.00239063, 0.00221907, 0.00246768, 0.0023451 , 0.00197066,
				      0.00201886, 0.00187633, 0.00156948, 0.00170548, 0.00160687, 0.00158683,
				      0.00162849, 0.00146277, 0.00127415, 0.00125812, 0.00119721, 0.00128844,
				      0.00097361, 0.00103202, 0.00093056, 0.00087748, 0.000809  , 0.00055511,
				      0.00063315, 0.00086532, 0.00077596, 0.00055785};

  TH1F* hFirstBin_sig_pp = new TH1F("hFirstBin_sig_pp", "12 GeV/c< p_{T} < 14 GeV/c;#sigma^{2}_{long};arbitary units", 100, 0, 2.00);
  TH1F* hFirstBin_bkg_pp = new TH1F("hFirstBin_bkg_pp", "12 GeV/c< p_{T} < 14 GeV/c;#sigma^{2}_{long};arbitary units", 100, 0, 2.00);
  TH1F* hFirstBin_sig_pPb = new TH1F("hFirstBin_sig_pPb", "12 GeV/c< p_{T} < 14 GeV/c;#sigma^{2}_{long};arbitary units", 100, 0, 2.00);
  TH1F* hFirstBin_bkg_pPb = new TH1F("hFirstBin_bkg_pPb", "12 GeV/c< p_{T} < 14 GeV/c;#sigma^{2}_{long};arbitary units", 100, 0, 2.00);
  TH1F* hFirstBin_sig_rat = new TH1F("hFirstBin_sig_rat", "Signal: 12 GeV/c< p_{T} < 14 GeV/c;#sigma^{2}_{long};pp/pPb", 100, 0, 2.00);
  TH1F* hFirstBin_bkg_rat = new TH1F("hFirstBin_bkg_rat", "Background: 12 GeV/c< p_{T} < 14 GeV/c;#sigma^{2}_{long};pp/pPb", 100, 0, 2.00);

  for(int i = 1; i <  hFirstBin_sig_pp->GetNbinsX(); i++){
    hFirstBin_sig_pp->SetBinContent(i, firstBin_sig_pp[i]);
    hFirstBin_bkg_pp->SetBinContent(i, firstBin_bkg_pp[i]);
    hFirstBin_sig_pPb->SetBinContent(i, firstBin_sig_pPb[i]);
    hFirstBin_bkg_pPb->SetBinContent(i, firstBin_bkg_pPb[i]);
  }
  
  
  hFirstBin_sig_rat->Divide(hFirstBin_sig_pp, hFirstBin_sig_pPb);
  TCanvas* cFirstBin_sig = new TCanvas("cFirstBin_sig", "cFirstBin_sig");
  hFirstBin_sig_rat->GetXaxis()->SetRangeUser(0.1, 0.3);
  hFirstBin_sig_rat->GetYaxis()->SetRangeUser(0.5, 1.5);
  hFirstBin_sig_rat->SetMarkerStyle(kFullCircle);
  hFirstBin_sig_rat->Draw("P");
  hFirstBin_sig_rat->Fit("pol0", "", "", 0.1, 0.3);
  TLegend* lFirstBin_sig = new TLegend(0.13, 0.13, 0.7, 0.35);
  lFirstBin_sig->SetFillStyle(0);
  lFirstBin_sig->AddEntry((TObject*)0, Form("#chi^{2} = %f", hFirstBin_sig_rat->GetFunction("pol0")->GetChisquare()), "");
  lFirstBin_sig->AddEntry((TObject*)0, Form("NDF = %i", hFirstBin_sig_rat->GetFunction("pol0")->GetNDF()), "");
  lFirstBin_sig->AddEntry(hFirstBin_sig_rat->GetFunction("pol0"), Form("Constant Fit: %f #pm %f", hFirstBin_sig_rat->GetFunction("pol0")->GetParameter(0), hFirstBin_sig_rat->GetFunction("pol0")->GetParError(0)), "l");
  lFirstBin_sig->Draw("same");
  
  
  hFirstBin_bkg_rat->Rebin(4);
  hFirstBin_bkg_rat->Divide(hFirstBin_bkg_pp->Rebin(4), hFirstBin_bkg_pPb->Rebin(4));
  TCanvas* cFirstBin_bkg = new TCanvas("cFirstBin_bkg", "cFirstBin_bkg");
  hFirstBin_bkg_rat->GetXaxis()->SetRangeUser(0.4, 1.5);
  hFirstBin_bkg_rat->GetYaxis()->SetRangeUser(0.5, 1.5);
  hFirstBin_bkg_rat->SetMarkerStyle(kFullCircle);
  hFirstBin_bkg_rat->Draw("P");
  hFirstBin_bkg_rat->Fit("pol0", "", "", 0.4, 1.5);
  TLegend* lFirstBin_bkg = new TLegend(0.13, 0.13, 0.8, 0.35);
  lFirstBin_bkg->SetFillStyle(0);
  lFirstBin_bkg->AddEntry((TObject*)0, Form("#chi^{2} = %f", hFirstBin_bkg_rat->GetFunction("pol0")->GetChisquare()), "");
  lFirstBin_bkg->AddEntry((TObject*)0, Form("NDF = %i", hFirstBin_bkg_rat->GetFunction("pol0")->GetNDF()), "");
  lFirstBin_bkg->AddEntry(hFirstBin_bkg_rat->GetFunction("pol0"), Form("Constant Fit: %f #pm %f", hFirstBin_bkg_rat->GetFunction("pol0")->GetParameter(0), hFirstBin_bkg_rat->GetFunction("pol0")->GetParError(0)), "l");
  lFirstBin_bkg->Draw("same");

  /********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/


  //Second pt bin
  Double_t secondBin_sig_pp[nbins] = {0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
				     0.00000000e+00, 1.29591313e-03, 4.89633204e-03, 1.42346891e-02,
				     2.97799893e-02, 5.49669862e-02, 9.14228633e-02, 1.49580866e-01,
				     2.65976906e-01, 9.20303836e-02, 5.47491908e-02, 3.74714620e-02,
				     2.74587050e-02, 2.00660657e-02, 1.51909236e-02, 1.31748179e-02,
				     1.08646937e-02, 9.06448718e-03, 8.62074178e-03, 7.67356483e-03,
				     6.57986244e-03, 5.76874241e-03, 5.82687184e-03, 5.50227659e-03,
				     4.52606566e-03, 4.20217263e-03, 3.79959168e-03, 3.34662828e-03,
				     3.41363344e-03, 2.65120436e-03, 2.68743327e-03, 2.30459287e-03,
				     2.33612116e-03, 2.46720389e-03, 1.93290354e-03, 2.07728962e-03,
				     1.80085097e-03, 1.51224202e-03, 1.84914994e-03, 1.67437142e-03,
				     1.29361183e-03, 1.32455269e-03, 1.48096855e-03, 1.22473750e-03,
				     1.09033973e-03, 1.04765466e-03, 1.14745286e-03, 9.76920594e-04,
				     8.97109450e-04, 8.83170054e-04, 9.36067139e-04, 5.71232988e-04,
				     6.49921014e-04, 8.16733052e-04, 6.40201732e-04, 4.27389081e-04,
				     5.11970196e-04, 4.79180570e-04, 4.37353970e-04, 5.30621095e-04,
				     4.91692568e-04, 4.25140024e-04, 4.62381198e-04, 3.41794221e-04,
				     3.23065877e-04, 2.51454214e-04, 3.90345551e-04, 3.41271254e-04,
				     3.16889054e-04, 3.02856701e-04, 2.11293445e-04, 1.96872061e-04,
				     2.59822351e-04, 2.74147314e-04, 2.85817398e-04, 1.91905448e-04,
				     1.83696291e-04, 2.82221590e-04, 1.54052803e-04, 2.11693012e-04,
				     1.67866034e-04, 2.19412206e-04, 2.01667732e-04, 1.55658461e-04,
				     4.85104792e-05, 1.64710524e-04, 1.57135481e-04, 8.83855246e-05,
				     8.05046075e-05, 1.04401624e-04, 1.16641364e-04, 6.04611450e-05,
				     1.04141043e-04, 1.22974132e-04, 7.63564531e-05, 8.67860363e-05};

  Double_t secondBin_bkg_pp[nbins] = {0.        , 0.        , 0.        , 0.        , 0.        , 0.00011291,
				     0.00135778, 0.00480387, 0.00825244, 0.01597348, 0.02711324, 0.04397652,
				     0.07474991, 0.02355986, 0.01702116, 0.01454167, 0.01796422, 0.01880384,
				     0.01666828, 0.01522605, 0.02097525, 0.01732889, 0.02194933, 0.02174758,
				     0.02216146, 0.0232204 , 0.02388621, 0.02513719, 0.02908154, 0.02805994,
				     0.02762624, 0.02492396, 0.02381448, 0.0230274 , 0.02348854, 0.02304828,
				     0.01994368, 0.02252545, 0.01748295, 0.01663465, 0.01739436, 0.01413565,
				     0.01302322, 0.01038342, 0.0093303 , 0.01022937, 0.00954945, 0.00974135,
				     0.00818917, 0.00805581, 0.00727318, 0.00537543, 0.00583792, 0.00687467,
				     0.00559203, 0.00761352, 0.00577913, 0.00456039, 0.0069145 , 0.00403084,
				     0.00422883, 0.00334011, 0.00276615, 0.00366282, 0.00345731, 0.00214396,
				     0.0022382 , 0.00203623, 0.00327455, 0.00197112, 0.00216638, 0.00261717,
				     0.00249836, 0.00092471, 0.00198439, 0.00163786, 0.00200745, 0.00253204,
				     0.0015145 , 0.00241144, 0.00153048, 0.00107312, 0.00084589, 0.00171201,
				     0.00129132, 0.00112612, 0.0010932 , 0.00159903, 0.00099309, 0.00090834,
				     0.00244183, 0.00103418, 0.00123454, 0.00110593, 0.00120458, 0.00109878,
				     0.00085456, 0.00056148, 0.00117518, 0.00163042};
  
  Double_t secondBin_sig_pPb[nbins] = {0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
				      0.00000000e+00, 1.33334089e-03, 4.45764652e-03, 1.42352330e-02,
				      3.22724804e-02, 6.08164929e-02, 9.97526646e-02, 1.61817476e-01,
				      2.75083333e-01, 9.28274766e-02, 5.60670123e-02, 3.71526219e-02,
				      2.49084458e-02, 1.67933218e-02, 1.23342546e-02, 9.37544927e-03,
				      8.52428377e-03, 7.34722894e-03, 6.31012814e-03, 5.75332204e-03,
				      5.09481644e-03, 4.85266559e-03, 3.81275057e-03, 3.97078786e-03,
				      3.40567878e-03, 3.34314816e-03, 3.12311272e-03, 2.39836099e-03,
				      2.96344399e-03, 2.25080340e-03, 1.63616519e-03, 2.23536883e-03,
				      2.07625655e-03, 1.79048523e-03, 1.57748058e-03, 1.42799655e-03,
				      1.19039055e-03, 1.62387453e-03, 1.19203446e-03, 1.11833413e-03,
				      1.22140232e-03, 1.05793308e-03, 1.20393431e-03, 1.00906298e-03,
				      1.01664336e-03, 8.70776013e-04, 1.09191251e-03, 6.78073848e-04,
				      6.64368155e-04, 7.82198214e-04, 7.50327250e-04, 7.62283395e-04,
				      4.35943890e-04, 6.70107082e-04, 5.06677199e-04, 4.86107689e-04,
				      5.19361172e-04, 3.77392455e-04, 6.56499527e-04, 2.66135437e-04,
				      3.02952452e-04, 3.79543460e-04, 4.42325574e-04, 2.31576982e-04,
				      3.71736736e-04, 2.78966356e-04, 2.65056820e-04, 2.93874502e-04,
				      3.04481277e-04, 2.91569682e-04, 2.45022558e-04, 1.90053426e-04,
				      1.76853573e-04, 1.52634879e-04, 2.27994693e-04, 2.13144711e-04,
				      2.62394344e-04, 1.54654568e-04, 1.60506024e-04, 2.16243643e-04,
				      7.74795408e-05, 1.21863166e-04, 5.42882044e-05, 1.46755920e-04,
				      2.10139580e-04, 5.28844284e-05, 1.60201511e-04, 1.07774162e-04,
				      1.14891198e-04, 1.36069735e-04, 6.26226756e-05, 2.31456925e-05,
				      7.63277567e-05, 4.92565050e-05, 5.58239117e-05, 1.15579642e-04};
  
  Double_t secondBin_bkg_pPb[nbins] = {0.        , 0.        , 0.        , 0.        , 0.        , 0.000528,
				      0.0011857 , 0.00365025, 0.00922365, 0.0135301 , 0.02609294, 0.04467223,
				      0.07445945, 0.02402946, 0.01690256, 0.01619165, 0.01527681, 0.01531433,
				      0.01859783, 0.02030707, 0.02020691, 0.02373242, 0.02391931, 0.02331059,
				      0.0235233 , 0.02682785, 0.02801996, 0.02868187, 0.02832182, 0.02872368,
				      0.02818478, 0.02781336, 0.0274932 , 0.0259092 , 0.02433795, 0.02190975,
				      0.02141742, 0.02149609, 0.01707219, 0.01554256, 0.01543947, 0.01209151,
				      0.0113463 , 0.01046289, 0.00906715, 0.01041012, 0.00830811, 0.00795736,
				      0.00722738, 0.00716909, 0.00735467, 0.0051105 , 0.00674965, 0.00508497,
				      0.00613424, 0.0044112 , 0.00443661, 0.00393751, 0.0039401 , 0.00396858,
				      0.00358894, 0.00293473, 0.00282412, 0.00337464, 0.0030431 , 0.00248192,
				      0.00240696, 0.00274413, 0.00203631, 0.00163783, 0.00235452, 0.00153074,
				      0.00162978, 0.0015929 , 0.00134183, 0.00162205, 0.00137406, 0.00134267,
				      0.0012409 , 0.00128891, 0.00121501, 0.00157875, 0.00154935, 0.00153548,
				      0.00148391, 0.00141128, 0.00065247, 0.00132911, 0.00126317, 0.00094631,
				      0.00088783, 0.00052775, 0.00080956, 0.00079165, 0.00075796, 0.0008686,
				      0.00070371, 0.00103215, 0.00082427, 0.00042703};

  TH1F* hSecondBin_sig_pp = new TH1F("hSecondBin_sig_pp", "15 GeV/c< p_{T} < 20 GeV/c;#sigma^{2}_{long};arbitary units", 100, 0, 2.00);
  TH1F* hSecondBin_bkg_pp = new TH1F("hSecondBin_bkg_pp", "15 GeV/c< p_{T} < 20 GeV/c;#sigma^{2}_{long};arbitary units", 100, 0, 2.00);
  TH1F* hSecondBin_sig_pPb = new TH1F("hSecondBin_sig_pPb", "15 GeV/c< p_{T} < 20 GeV/c;#sigma^{2}_{long};arbitary units", 100, 0, 2.00);
  TH1F* hSecondBin_bkg_pPb = new TH1F("hSecondBin_bkg_pPb", "15 GeV/c< p_{T} < 20 GeV/c;#sigma^{2}_{long};arbitary units", 100, 0, 2.00);
  TH1F* hSecondBin_sig_rat = new TH1F("hSecondBin_sig_rat", "Signal: 15 GeV/c< p_{T} < 20 GeV/c;#sigma^{2}_{long};pp/pPb", 100, 0, 2.00);
  TH1F* hSecondBin_bkg_rat = new TH1F("hSecondBin_bkg_rat", "Background: 15 GeV/c< p_{T} < 20 GeV/c;#sigma^{2}_{long};pp/pPb", 100, 0, 2.00);

  for(int i = 1; i <  hSecondBin_sig_pp->GetNbinsX(); i++){
    hSecondBin_sig_pp->SetBinContent(i, secondBin_sig_pp[i]);
    hSecondBin_bkg_pp->SetBinContent(i, secondBin_bkg_pp[i]);
    hSecondBin_sig_pPb->SetBinContent(i, secondBin_sig_pPb[i]);
    hSecondBin_bkg_pPb->SetBinContent(i, secondBin_bkg_pPb[i]);
  }
  
  
  hSecondBin_sig_rat->Divide(hSecondBin_sig_pp, hSecondBin_sig_pPb);
  TCanvas* cSecondBin_sig = new TCanvas("cSecondBin_sig", "cSecondBin_sig");
  hSecondBin_sig_rat->GetXaxis()->SetRangeUser(0.1, 0.3);
  hSecondBin_sig_rat->GetYaxis()->SetRangeUser(0.5, 1.5);
  hSecondBin_sig_rat->SetMarkerStyle(kFullCircle);
  hSecondBin_sig_rat->Draw("P");
  hSecondBin_sig_rat->Fit("pol0", "", "", 0.1, 0.3);
  TLegend* lSecondBin_sig = new TLegend(0.13, 0.13, 0.8, 0.35);
  lSecondBin_sig->SetFillStyle(0);
  lSecondBin_sig->AddEntry((TObject*)0, Form("#chi^{2} = %f", hSecondBin_sig_rat->GetFunction("pol0")->GetChisquare()), "");
  lSecondBin_sig->AddEntry((TObject*)0, Form("NDF = %i", hSecondBin_sig_rat->GetFunction("pol0")->GetNDF()), "");
  lSecondBin_sig->AddEntry(hSecondBin_sig_rat->GetFunction("pol0"), Form("Constant Fit: %f #pm %f", hSecondBin_sig_rat->GetFunction("pol0")->GetParameter(0), hSecondBin_sig_rat->GetFunction("pol0")->GetParError(0)), "l");
  lSecondBin_sig->Draw("same");
  
  
  hSecondBin_bkg_rat->Rebin(4);
  hSecondBin_bkg_rat->Divide(hSecondBin_bkg_pp->Rebin(4), hSecondBin_bkg_pPb->Rebin(4));
  TCanvas* cSecondBin_bkg = new TCanvas("cSecondBin_bkg", "cSecondBin_bkg");
  hSecondBin_bkg_rat->GetXaxis()->SetRangeUser(0.4, 1.5);
  hSecondBin_bkg_rat->GetYaxis()->SetRangeUser(0.5, 1.5);
  hSecondBin_bkg_rat->SetMarkerStyle(kFullCircle);
  hSecondBin_bkg_rat->Draw("P");
  hSecondBin_bkg_rat->Fit("pol0", "", "", 0.4, 1.5);
  TLegend* lSecondBin_bkg = new TLegend(0.13, 0.13, 0.8, 0.35);
  lSecondBin_bkg->SetFillStyle(0);
  lSecondBin_bkg->AddEntry((TObject*)0, Form("#chi^{2} = %f", hSecondBin_bkg_rat->GetFunction("pol0")->GetChisquare()), "");
  lSecondBin_bkg->AddEntry((TObject*)0, Form("NDF = %i", hSecondBin_bkg_rat->GetFunction("pol0")->GetNDF()), "");
  lSecondBin_bkg->AddEntry(hSecondBin_bkg_rat->GetFunction("pol0"), Form("Constant Fit: %f #pm %f", hSecondBin_bkg_rat->GetFunction("pol0")->GetParameter(0), hSecondBin_bkg_rat->GetFunction("pol0")->GetParError(0)), "l");
  lSecondBin_bkg->Draw("same");

  /********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/

  //third bin
  Double_t thirdBin_sig_pp[nbins] = {0.0000000e+00, 0.0000000e+00, 0.0000000e+00, 0.0000000e+00, 0.0000000e+00,
				     1.2841998e-03, 5.1639541e-03, 1.4793263e-02, 3.2255396e-02, 6.2558286e-02,
				     9.7799912e-02, 1.6133209e-01, 2.6988235e-01, 8.5772820e-02, 5.5273283e-02,
				     3.9665695e-02, 2.5372414e-02, 1.8994868e-02, 1.2985401e-02, 1.1958810e-02,
				     1.0431189e-02, 8.7121269e-03, 6.9228816e-03, 6.9360561e-03, 5.5529457e-03,
				     4.9509108e-03, 5.2002543e-03, 4.0379455e-03, 3.3840723e-03, 3.1952956e-03,
				     3.0598363e-03, 2.8417748e-03, 2.6777566e-03, 2.2230344e-03, 1.8957927e-03,
				     2.1360719e-03, 2.0147623e-03, 2.3857250e-03, 1.6859185e-03, 1.6066293e-03,
				     1.1881058e-03, 1.3299161e-03, 1.2726472e-03, 1.1854534e-03, 1.0628928e-03,
				     9.6052838e-04, 7.7799644e-04, 8.2888181e-04, 8.8567671e-04, 8.6318993e-04,
				     6.4461073e-04, 8.4138539e-04, 6.7536475e-04, 4.9802655e-04, 5.1796052e-04,
				     6.9829077e-04, 4.5259891e-04, 4.2672316e-04, 4.9348082e-04, 4.3517165e-04,
				     4.1717043e-04, 4.7482096e-04, 3.4597228e-04, 4.2763344e-04, 3.9053624e-04,
				     1.8383417e-04, 2.7584631e-04, 1.9683197e-04, 3.6051552e-04, 3.4837759e-04,
				     2.1848381e-04, 1.2334414e-04, 1.4520895e-04, 1.7808173e-04, 2.8018482e-04,
				     2.2311920e-04, 7.7847086e-05, 1.6543127e-04, 2.0191638e-04, 1.6745499e-04,
				     7.7052631e-05, 1.7982266e-04, 9.2923612e-05, 1.4969824e-04, 1.3984440e-04,
				     8.3719002e-05, 6.4229731e-05, 1.9449249e-04, 1.7223720e-04, 8.8214605e-05,
				     8.7053857e-05, 9.6686992e-05, 5.3948857e-05, 5.8022972e-05, 2.9007630e-05,
				     6.1927873e-05, 5.6214325e-05, 2.9631175e-05, 7.0134476e-05, 2.9913303e-05};
  
  Double_t thirdBin_bkg_pp[nbins] = {0.        , 0.        , 0.        , 0.        , 0.        , 0.,
				     0.        , 0.00235189, 0.00819188, 0.01384773, 0.02168322, 0.03610197,
				     0.07117305, 0.02530925, 0.02389853, 0.02928139, 0.03109893, 0.03012755,
				     0.03201914, 0.03888774, 0.04146859, 0.03533405, 0.03163047, 0.03504471,
				     0.03166325, 0.02323047, 0.03693982, 0.02754164, 0.02276227, 0.02223208,
				     0.01792334, 0.01282782, 0.02167462, 0.0159146 , 0.01300905, 0.01274102,
				     0.01461842, 0.00916674, 0.0113722 , 0.00942049, 0.012911  , 0.00477843,
				     0.01075855, 0.00748355, 0.01057345, 0.00398113, 0.00498422, 0.00537724,
				     0.00558359, 0.00824213, 0.00268193, 0.00430113, 0.0075252 , 0.00351536,
				     0.00437391, 0.00549371, 0.00431837, 0.00315486, 0.00667534, 0.00243213,
				     0.00501972, 0.00197172, 0.00282628, 0.00468791, 0.00287221, 0.00135307,
				     0.00196075, 0.00144323, 0.00100359, 0.00139922, 0.00169883, 0.00495429,
				     0.0023015 , 0.00085665, 0.0018561 , 0.00183834, 0.00152564, 0.00145751,
				     0.00262479, 0.00126606, 0.00053199, 0.00209024, 0.00100958, 0.00412506,
				     0.00140777, 0.00168988, 0.00176651, 0.00173192, 0.00091129, 0.00232104,
				     0.00063998, 0.00063301, 0.00151185, 0.00053425, 0.00028454, 0.00049928,
				     0.00111628, 0.00064833, 0.00154021, 0.00045642};

  Double_t thirdBin_sig_pPb[nbins] = {0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
				      0.00000000e+00, 1.05566112e-03, 5.10728313e-03, 1.46585582e-02,
				      3.45050581e-02, 6.37507811e-02, 1.02389291e-01, 1.68280438e-01,
				      2.80366689e-01, 9.19868350e-02, 5.69023490e-02, 3.55800688e-02,
				      2.50269864e-02, 1.65376142e-02, 1.17882062e-02, 9.45684593e-03,
				      6.78315712e-03, 6.26120856e-03, 5.77895949e-03, 4.91813757e-03,
				      4.44148993e-03, 4.20811865e-03, 3.78363533e-03, 2.85015232e-03,
				      3.47589888e-03, 2.61854730e-03, 2.69904430e-03, 2.04019668e-03,
				      1.99518399e-03, 1.83156237e-03, 1.83657149e-03, 1.58046838e-03,
				      1.42326276e-03, 1.34115585e-03, 1.39408221e-03, 1.28959841e-03,
				      1.18719612e-03, 1.35896064e-03, 8.29357072e-04, 9.82629019e-04,
				      7.38510164e-04, 1.04654010e-03, 8.64561065e-04, 5.17771114e-04,
				      5.68594551e-04, 7.87389057e-04, 6.29327376e-04, 5.07683610e-04,
				      5.08321915e-04, 4.82600095e-04, 4.09010507e-04, 5.08935482e-04,
				      5.46568946e-04, 5.94415294e-04, 3.80301703e-04, 3.20698688e-04,
				      4.52632841e-04, 2.50040030e-04, 3.59640137e-04, 3.14149074e-04,
				      2.97574647e-04, 1.30418368e-04, 3.01450636e-04, 2.72934820e-04,
				      2.32193925e-04, 3.81187419e-04, 1.42013392e-04, 2.73738056e-04,
				      1.37070252e-04, 1.88254911e-04, 1.45259328e-04, 1.50761611e-04,
				      1.95414788e-04, 9.93674767e-05, 6.42657469e-05, 1.02651356e-04,
				      1.61973963e-04, 2.22589675e-04, 4.83741460e-05, 1.42798483e-04,
				      4.24364407e-05, 1.49730753e-04, 1.00571509e-04, 8.06125827e-05,
				      1.13215523e-04, 1.39705924e-04, 4.59297917e-05, 3.51017261e-05,
				      1.06893516e-04, 6.13826633e-05, 9.38305675e-05, 3.77555516e-05,
				      4.36586197e-05, 4.67330283e-05, 7.97549146e-05, 4.34491485e-05};
  
  Double_t thirdBin_bkg_pPb[nbins] = {0.        , 0.        , 0.        , 0.        , 0.        , 0.,
				      0.00129344, 0.00114108, 0.00546397, 0.01347617, 0.01620219, 0.03181146,
				      0.07414843, 0.03467828, 0.0287627 , 0.03362076, 0.03996902, 0.03552179,
				      0.03481444, 0.03829193, 0.03638823, 0.03849867, 0.03470094, 0.03516071,
				      0.03047116, 0.03053971, 0.02937648, 0.02451077, 0.02640308, 0.02609533,
				      0.022241  , 0.01918647, 0.01686248, 0.0135269 , 0.01343978, 0.00965009,
				      0.01143746, 0.00906519, 0.00919211, 0.00879838, 0.01128995, 0.00567661,
				      0.00738223, 0.00718474, 0.00600148, 0.00720718, 0.00435425, 0.00650946,
				      0.00698072, 0.00598127, 0.00350523, 0.00303796, 0.0047122 , 0.00324297,
				      0.00214433, 0.00231734, 0.00331431, 0.00244256, 0.00362954, 0.00249145,
				      0.00275845, 0.00096242, 0.00213168, 0.0031841 , 0.00167726, 0.00265437,
				      0.00215917, 0.00252452, 0.00320691, 0.00187953, 0.00341058, 0.00138091,
				      0.00275134, 0.00222645, 0.00212211, 0.0018565 , 0.00176861, 0.00140863,
				      0.00126052, 0.00139681, 0.00112407, 0.00143754, 0.00124803, 0.00205389,
				      0.00125261, 0.00112801, 0.0007178 , 0.00167106, 0.00075272, 0.00125006,
				      0.00051477, 0.0013958 , 0.00058704, 0.00186438, 0.00133584, 0.00114398,
				      0.00114494, 0.00065839, 0.00066664, 0.00118522};

  TH1F* hThirdBin_sig_pp = new TH1F("hThirdBin_sig_pp", "20 GeV/c< p_{T} < 25 GeV/c;#sigma^{2}_{long};arbitary units", 100, 0, 2.00);
  TH1F* hThirdBin_bkg_pp = new TH1F("hThirdBin_bkg_pp", "20 GeV/c< p_{T} < 25 GeV/c;#sigma^{2}_{long};arbitary units", 100, 0, 2.00);
  TH1F* hThirdBin_sig_pPb = new TH1F("hThirdBin_sig_pPb", "20 GeV/c< p_{T} < 25 GeV/c;#sigma^{2}_{long};arbitary units", 100, 0, 2.00);
  TH1F* hThirdBin_bkg_pPb = new TH1F("hThirdBin_bkg_pPb", "20 GeV/c< p_{T} < 25 GeV/c;#sigma^{2}_{long};arbitary units", 100, 0, 2.00);
  TH1F* hThirdBin_sig_rat = new TH1F("hThirdBin_sig_rat", "Signal: 20 GeV/c< p_{T} < 25 GeV/c;#sigma^{2}_{long};pp/pPb", 100, 0, 2.00);
  TH1F* hThirdBin_bkg_rat = new TH1F("hThirdBin_bkg_rat", "Background: 20 GeV/c< p_{T} < 25 GeV/c;#sigma^{2}_{long};pp/pPb", 100, 0, 2.00);

  for(int i = 1; i <  hThirdBin_sig_pp->GetNbinsX(); i++){
    hThirdBin_sig_pp->SetBinContent(i, thirdBin_sig_pp[i]);
    hThirdBin_bkg_pp->SetBinContent(i, thirdBin_bkg_pp[i]);
    hThirdBin_sig_pPb->SetBinContent(i, thirdBin_sig_pPb[i]);
    hThirdBin_bkg_pPb->SetBinContent(i, thirdBin_bkg_pPb[i]);
  }
  
  
  hThirdBin_sig_rat->Divide(hThirdBin_sig_pp, hThirdBin_sig_pPb);
  TCanvas* cThirdBin_sig = new TCanvas("cThirdBin_sig", "cThirdBin_sig");
  hThirdBin_sig_rat->GetXaxis()->SetRangeUser(0.1, 0.3);
  hThirdBin_sig_rat->GetYaxis()->SetRangeUser(0.5, 1.5);
  hThirdBin_sig_rat->SetMarkerStyle(kFullCircle);
  hThirdBin_sig_rat->Draw("P");
  hThirdBin_sig_rat->Fit("pol0", "", "", 0.1, 0.3);
  TLegend* lThirdBin_sig = new TLegend(0.13, 0.13, 0.8, 0.35);
  lThirdBin_sig->SetFillStyle(0);
  lThirdBin_sig->AddEntry((TObject*)0, Form("#chi^{2} = %f", hThirdBin_sig_rat->GetFunction("pol0")->GetChisquare()), "");
  lThirdBin_sig->AddEntry((TObject*)0, Form("NDF = %i", hThirdBin_sig_rat->GetFunction("pol0")->GetNDF()), "");
  lThirdBin_sig->AddEntry(hThirdBin_sig_rat->GetFunction("pol0"), Form("Constant Fit: %f #pm %f", hThirdBin_sig_rat->GetFunction("pol0")->GetParameter(0), hThirdBin_sig_rat->GetFunction("pol0")->GetParError(0)), "l");
  lThirdBin_sig->Draw("same");
  
  
  hThirdBin_bkg_rat->Rebin(4);
  hThirdBin_bkg_rat->Divide(hThirdBin_bkg_pp->Rebin(4), hThirdBin_bkg_pPb->Rebin(4));
  TCanvas* cThirdBin_bkg = new TCanvas("cThirdBin_bkg", "cThirdBin_bkg");
  hThirdBin_bkg_rat->GetXaxis()->SetRangeUser(0.4, 1.5);
  hThirdBin_bkg_rat->GetYaxis()->SetRangeUser(0.5, 1.5);
  hThirdBin_bkg_rat->SetMarkerStyle(kFullCircle);
  hThirdBin_bkg_rat->Draw("P");
  hThirdBin_bkg_rat->Fit("pol0", "", "", 0.4, 1.5);
  TLegend* lThirdBin_bkg = new TLegend(0.13, 0.13, 0.8, 0.35);
  lThirdBin_bkg->SetFillStyle(0);
  lThirdBin_bkg->AddEntry((TObject*)0, Form("#chi^{2} = %f", hThirdBin_bkg_rat->GetFunction("pol0")->GetChisquare()), "");
  lThirdBin_bkg->AddEntry((TObject*)0, Form("NDF = %i", hThirdBin_bkg_rat->GetFunction("pol0")->GetNDF()), "");
  lThirdBin_bkg->AddEntry(hThirdBin_bkg_rat->GetFunction("pol0"), Form("Constant Fit: %f #pm %f", hThirdBin_bkg_rat->GetFunction("pol0")->GetParameter(0), hThirdBin_bkg_rat->GetFunction("pol0")->GetParError(0)), "l");
  lThirdBin_bkg->Draw("same");

  /********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/

  //fourth bin
  Double_t fourthBin_sig_pp[nbins] = {0.0000000e+00, 0.0000000e+00, 0.0000000e+00, 0.0000000e+00, 0.0000000e+00,
				     1.2841998e-03, 5.1639541e-03, 1.4793263e-02, 3.2255396e-02, 6.2558286e-02,
				     9.7799912e-02, 1.6133209e-01, 2.6988235e-01, 8.5772820e-02, 5.5273283e-02,
				     3.9665695e-02, 2.5372414e-02, 1.8994868e-02, 1.2985401e-02, 1.1958810e-02,
				     1.0431189e-02, 8.7121269e-03, 6.9228816e-03, 6.9360561e-03, 5.5529457e-03,
				     4.9509108e-03, 5.2002543e-03, 4.0379455e-03, 3.3840723e-03, 3.1952956e-03,
				     3.0598363e-03, 2.8417748e-03, 2.6777566e-03, 2.2230344e-03, 1.8957927e-03,
				     2.1360719e-03, 2.0147623e-03, 2.3857250e-03, 1.6859185e-03, 1.6066293e-03,
				     1.1881058e-03, 1.3299161e-03, 1.2726472e-03, 1.1854534e-03, 1.0628928e-03,
				     9.6052838e-04, 7.7799644e-04, 8.2888181e-04, 8.8567671e-04, 8.6318993e-04,
				     6.4461073e-04, 8.4138539e-04, 6.7536475e-04, 4.9802655e-04, 5.1796052e-04,
				     6.9829077e-04, 4.5259891e-04, 4.2672316e-04, 4.9348082e-04, 4.3517165e-04,
				     4.1717043e-04, 4.7482096e-04, 3.4597228e-04, 4.2763344e-04, 3.9053624e-04,
				     1.8383417e-04, 2.7584631e-04, 1.9683197e-04, 3.6051552e-04, 3.4837759e-04,
				     2.1848381e-04, 1.2334414e-04, 1.4520895e-04, 1.7808173e-04, 2.8018482e-04,
				     2.2311920e-04, 7.7847086e-05, 1.6543127e-04, 2.0191638e-04, 1.6745499e-04,
				     7.7052631e-05, 1.7982266e-04, 9.2923612e-05, 1.4969824e-04, 1.3984440e-04,
				     8.3719002e-05, 6.4229731e-05, 1.9449249e-04, 1.7223720e-04, 8.8214605e-05,
				     8.7053857e-05, 9.6686992e-05, 5.3948857e-05, 5.8022972e-05, 2.9007630e-05,
				     6.1927873e-05, 5.6214325e-05, 2.9631175e-05, 7.0134476e-05, 2.9913303e-05};
  
  Double_t fourthBin_bkg_pp[nbins] = {0.        , 0.        , 0.        , 0.        , 0.        , 0.,
				     0.0020025 , 0.00188715, 0.00806829, 0.01808161, 0.01568808, 0.02991784,
				     0.08291852, 0.0660556 , 0.04908029, 0.05489941, 0.03523802, 0.03827622,
				     0.0474725 , 0.03263792, 0.0337952 , 0.03705137, 0.02886049, 0.03110454,
				     0.01815365, 0.01755307, 0.02713208, 0.01895014, 0.01204124, 0.01182123,
				     0.01045858, 0.01810852, 0.01134607, 0.00823052, 0.01270261, 0.00651793,
				     0.00663333, 0.007129  , 0.00665087, 0.00310046, 0.00937391, 0.00923984,
				     0.00611297, 0.00271461, 0.00689178, 0.00372031, 0.00369711, 0.00213414,
				     0.00613161, 0.0024036 , 0.0047872 , 0.00365183, 0.00326614, 0.00333671,
				     0.00317101, 0.00334317, 0.00435809, 0.00439088, 0.00372242, 0.00446051,
				     0.00691854, 0.00160617, 0.00184417, 0.00430408, 0.0006792 , 0.00112571,
				     0.00416336, 0.00287351, 0.0006626 , 0.00332255, 0.00305199, 0.00266711,
				     0.00302839, 0.00172728, 0.00143758, 0.00393635, 0.00405358, 0.00335639,
				     0.0006475 , 0.00224008, 0.00064556, 0.00470469, 0.00139249, 0.00401352,
				     0.00198522, 0.0026005 , 0.00224206, 0.00401188, 0.0007852 , 0.00067418,
				     0.        , 0.00127684, 0.00213994, 0.00051929, 0.00349386, 0.00275231,
				     0.0031191 , 0.00262078, 0.00230846, 0.00459528};

  Double_t fourthBin_sig_pPb[nbins] = {0.0000000e+00, 0.0000000e+00, 0.0000000e+00, 0.0000000e+00, 0.0000000e+00,
				      1.4117078e-03, 5.2511855e-03, 1.6498590e-02, 3.7915532e-02, 6.8451501e-02,
				      1.0521913e-01, 1.6974898e-01, 2.9000232e-01, 8.9077264e-02, 5.4667920e-02,
				      3.4482669e-02, 2.2458214e-02, 1.3977480e-02, 1.0165150e-02, 8.3271815e-03,
				      6.8823970e-03, 5.6011989e-03, 4.9750232e-03, 4.0001268e-03, 3.5007065e-03,
				      2.9973160e-03, 3.0393933e-03, 2.6699232e-03, 2.2830621e-03, 2.1698680e-03,
				      2.0147185e-03, 1.5067754e-03, 1.3178240e-03, 1.4230316e-03, 1.1030929e-03,
				      1.0463084e-03, 1.5034002e-03, 1.1217976e-03, 1.1106225e-03, 1.0616380e-03,
				      7.9544808e-04, 8.3554751e-04, 7.3078828e-04, 7.6126721e-04, 7.4148143e-04,
				      7.1018335e-04, 5.3048378e-04, 6.1746017e-04, 6.5472710e-04, 4.3241403e-04,
				      5.8201386e-04, 4.0422293e-04, 5.5652327e-04, 3.7374609e-04, 3.0966240e-04,
				      4.3683042e-04, 2.8268641e-04, 3.3195174e-04, 3.6376104e-04, 2.5165229e-04,
				      3.0491708e-04, 4.4182295e-04, 3.0531516e-04, 2.0185272e-04, 2.8401887e-04,
				      3.6804544e-04, 2.2993909e-04, 4.0018783e-04, 2.4240679e-04, 2.3838847e-04,
				      2.3282399e-04, 2.7634675e-04, 2.5112223e-04, 2.6232662e-04, 1.8579408e-04,
				      2.1072949e-04, 1.9061063e-04, 3.1509699e-04, 1.8712654e-04, 2.7454292e-04,
				      2.0371942e-04, 4.0092110e-04, 2.3064931e-04, 2.2545776e-04, 2.5476137e-04,
				      2.1361439e-04, 2.6800632e-04, 1.9684553e-04, 2.4189769e-04, 2.3770548e-04,
				      2.5724820e-04, 1.6751888e-04, 3.2758564e-04, 1.8340362e-04, 2.2590610e-04,
				      2.9599841e-04, 2.0407767e-04, 2.7219855e-04, 1.6388185e-04, 3.3929912e-04};
  
  Double_t fourthBin_bkg_pPb[nbins] = {0.        , 0.        , 0.        , 0.        , 0.        , 0.00065181,
				      0.00041168, 0.00390019, 0.0074958 , 0.01085243, 0.0252649 , 0.03002005,
				      0.09226517, 0.0615179 , 0.04855212, 0.05535512, 0.04676707, 0.0479919,
				      0.03628729, 0.03811238, 0.03220043, 0.03510562, 0.02046042, 0.02627729,
				      0.02312031, 0.02227362, 0.02099103, 0.01487403, 0.01040518, 0.01210212,
				      0.01311068, 0.01066572, 0.00791693, 0.00726436, 0.0064361 , 0.00695535,
				      0.00579009, 0.0067745 , 0.00778708, 0.00657057, 0.0083797 , 0.00569275,
				      0.00571888, 0.00759405, 0.00401946, 0.00471418, 0.00454706, 0.00383118,
				      0.00586579, 0.00435792, 0.00415228, 0.00308522, 0.0047143 , 0.0035892,
				      0.00441269, 0.00386445, 0.0057006 , 0.00236844, 0.00337486, 0.00532583,
				      0.00268929, 0.00382209, 0.00477761, 0.00318634, 0.00211857, 0.00411688,
				      0.00370693, 0.00330679, 0.00246694, 0.00249594, 0.00551664, 0.0030266,
				      0.00277225, 0.0026748 , 0.00073162, 0.00393516, 0.0011687 , 0.00518294,
				      0.00182731, 0.00254773, 0.00245397, 0.00188102, 0.00077165, 0.00205977,
				      0.00248565, 0.00149801, 0.00130388, 0.00088506, 0.00108158, 0.00109672,
				      0.00232409, 0.00219083, 0.00327745, 0.00190031, 0.00334862, 0.00239435,
				      0.00225255, 0.00201458, 0.00286958, 0.00200315};
  
  TH1F* hFourthBin_sig_pp = new TH1F("hFourthBin_sig_pp", "25 GeV/c< p_{T} < 40 GeV/c;#sigma^{2}_{long};arbitary units", 100, 0, 2.00);
  TH1F* hFourthBin_bkg_pp = new TH1F("hFourthBin_bkg_pp", "25 GeV/c< p_{T} < 40 GeV/c;#sigma^{2}_{long};arbitary units", 100, 0, 2.00);
  TH1F* hFourthBin_sig_pPb = new TH1F("hFourthBin_sig_pPb", "25 GeV/c< p_{T} < 40 GeV/c;#sigma^{2}_{long};arbitary units", 100, 0, 2.00);
  TH1F* hFourthBin_bkg_pPb = new TH1F("hFourthBin_bkg_pPb", "25 GeV/c< p_{T} < 40 GeV/c;#sigma^{2}_{long};arbitary units", 100, 0, 2.00);
  TH1F* hFourthBin_sig_rat = new TH1F("hFourthBin_sig_rat", "Signal: 25 GeV/c< p_{T} < 40 GeV/c;#sigma^{2}_{long};pp/pPb", 100, 0, 2.00);
  TH1F* hFourthBin_bkg_rat = new TH1F("hFourthBin_bkg_rat", "Background: 25 GeV/c< p_{T} < 40 GeV/c;#sigma^{2}_{long};pp/pPb", 100, 0, 2.00);

  for(int i = 1; i <  hFourthBin_sig_pp->GetNbinsX(); i++){
    hFourthBin_sig_pp->SetBinContent(i, fourthBin_sig_pp[i]);
    hFourthBin_bkg_pp->SetBinContent(i, fourthBin_bkg_pp[i]);
    hFourthBin_sig_pPb->SetBinContent(i, fourthBin_sig_pPb[i]);
    hFourthBin_bkg_pPb->SetBinContent(i, fourthBin_bkg_pPb[i]);
  }
  
  
  hFourthBin_sig_rat->Divide(hFourthBin_sig_pp, hFourthBin_sig_pPb);
  TCanvas* cFourthBin_sig = new TCanvas("cFourthBin_sig", "cFourthBin_sig");
  hFourthBin_sig_rat->GetXaxis()->SetRangeUser(0.1, 0.3);
  hFourthBin_sig_rat->GetYaxis()->SetRangeUser(0.5, 1.5);
  hFourthBin_sig_rat->SetMarkerStyle(kFullCircle);
  hFourthBin_sig_rat->Draw("P");
  hFourthBin_sig_rat->Fit("pol0", "", "", 0.1, 0.3);
  TLegend* lFourthBin_sig = new TLegend(0.13, 0.13, 0.8, 0.35);
  lFourthBin_sig->SetFillStyle(0);
  lFourthBin_sig->AddEntry((TObject*)0, Form("#chi^{2} = %f", hFourthBin_sig_rat->GetFunction("pol0")->GetChisquare()), "");
  lFourthBin_sig->AddEntry((TObject*)0, Form("NDF = %i", hFourthBin_sig_rat->GetFunction("pol0")->GetNDF()), "");
  lFourthBin_sig->AddEntry(hFourthBin_sig_rat->GetFunction("pol0"), Form("Constant Fit: %f #pm %f", hFourthBin_sig_rat->GetFunction("pol0")->GetParameter(0), hFourthBin_sig_rat->GetFunction("pol0")->GetParError(0)), "l");
  lFourthBin_sig->Draw("same");
  
  
  hFourthBin_bkg_rat->Rebin(4);
  hFourthBin_bkg_rat->Divide(hFourthBin_bkg_pp->Rebin(4), hFourthBin_bkg_pPb->Rebin(4));
  TCanvas* cFourthBin_bkg = new TCanvas("cFourthBin_bkg", "cFourthBin_bkg");
  hFourthBin_bkg_rat->GetXaxis()->SetRangeUser(0.4, 1.5);
  hFourthBin_bkg_rat->GetYaxis()->SetRangeUser(0.5, 1.5);
  hFourthBin_bkg_rat->SetMarkerStyle(kFullCircle);
  hFourthBin_bkg_rat->Draw("P");
  hFourthBin_bkg_rat->Fit("pol0", "", "", 0.4, 1.5);
  TLegend* lFourthBin_bkg = new TLegend(0.13, 0.13, 0.8, 0.35);
  lFourthBin_bkg->SetFillStyle(0);
  lFourthBin_bkg->AddEntry((TObject*)0, Form("#chi^{2} = %f", hFourthBin_bkg_rat->GetFunction("pol0")->GetChisquare()), "");
  lFourthBin_bkg->AddEntry((TObject*)0, Form("NDF = %i", hFourthBin_bkg_rat->GetFunction("pol0")->GetNDF()), "");
  lFourthBin_bkg->AddEntry(hFourthBin_bkg_rat->GetFunction("pol0"), Form("Constant Fit: %f #pm %f", hFourthBin_bkg_rat->GetFunction("pol0")->GetParameter(0), hFourthBin_bkg_rat->GetFunction("pol0")->GetParError(0)), "l");
  lFourthBin_bkg->Draw("same");

  /********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/

  TCanvas* cBkg = new TCanvas("cBkg", "cBkg", 2000, 500);
  cBkg->Divide(4,1);
  cBkg->cd(1);
  hFirstBin_bkg_rat->Draw("P");
  lFirstBin_bkg->Draw("same");
  cBkg->cd(2);
  hSecondBin_bkg_rat->Draw("P");
  lSecondBin_bkg->Draw("same");
  cBkg->cd(3);
  hThirdBin_bkg_rat->Draw("P");
  lThirdBin_bkg->Draw("same");
  cBkg->cd(4);
  hFourthBin_bkg_rat->Draw("P");
  lFourthBin_bkg->Draw("same");
  //cBkg->SaveAs("bkgTemplateRatios.pdf");
  //cBkg->SaveAs("bkgTemplateRatios.png");

  TCanvas* cSig = new TCanvas("cSig", "cSig", 2000, 500);
  cSig->Divide(4,1);
  cSig->cd(1);
  hFirstBin_sig_rat->Draw("P");
  lFirstBin_sig->Draw("same");
  cSig->cd(2);
  hSecondBin_sig_rat->Draw("P");
  lSecondBin_sig->Draw("same");
  cSig->cd(3);
  hThirdBin_sig_rat->Draw("P");
  lThirdBin_sig->Draw("same");
  cSig->cd(4);
  hFourthBin_sig_rat->Draw("P");
  lFourthBin_sig->Draw("same");
  //cSig->SaveAs("sigTemplateRatios.pdf");
  //cSig->SaveAs("sigTemplateRatios.png");

  
}//end delveIntoPuritySys
